{"version":3,"file":"commonHelpers.js","sources":["../src/js/service/pixabay.js","../src/js/service/markup.js","../src/js/classes/toast.js","../src/js/classes/gallery.js","../src/js/classes/infinit-scroll.js","../src/js/classes/pagination.js","../src/js/classes/loader.js","../src/js/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44398563-cf059515c803c5aba714f6295';\nconst API_BASE_URL = 'https://pixabay.com/api/';\n\nexport async function searchImages(query, page = 1, perPage = 40) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: perPage,\n  };\n\n  const { data } = await axios.get(`${API_BASE_URL}?key=${API_KEY}`, {\n    params,\n  });\n  return data;\n}\n","export function renderGalleryItem(hit) {\n  const {\n    webformatURL,\n    tags,\n    largeImageURL,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = hit;\n  return `\n    <div class=\"photo-card\">\n      <a class='gallery__link' href=${largeImageURL}>\n        <img src=${webformatURL} alt=${tags} loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b>\n          ${likes}\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b>\n          ${views}\n        </p>\n        <p class=\"info-item\">\n          <b>Comments</b>\n          ${comments}\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads</b>\n          ${downloads}\n        </p>\n      </div>\n    </div>`;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport default class Toast {\n  constructor(position) {\n    iziToast.settings({ position });\n  }\n\n  warning(message) {\n    iziToast.warning({ message });\n  }\n\n  success(message) {\n    iziToast.success({ message });\n  }\n\n  error(message) {\n    iziToast.error({ message });\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport default class Gallery {\n  #gallery;\n  #lightBox;\n  createGalleryItem;\n\n  constructor(gallerySelector, createGalleryItem) {\n    this.#gallery = document.querySelector(gallerySelector);\n    this.#lightBox = new SimpleLightbox(`${gallerySelector} a`, {});\n    this.createGalleryItem = createGalleryItem;\n  }\n\n  clear() {\n    this.#gallery.innerHTML = '';\n  }\n\n  addItems(items) {\n    this.#gallery.insertAdjacentHTML(\n      'beforeend',\n      items.map(this.createGalleryItem).join('')\n    );\n    this.#lightBox.refresh();\n  }\n}\n","export default class InfiniteScroll {\n  #observer;\n  #callback;\n  #container;\n  #loading = false;\n\n  constructor(container) {\n    this.#container = container;\n    this.#observer = new IntersectionObserver(\n      entries => this.observeEntries(entries),\n      {\n        root: null,\n        rootMargin: '300px',\n        threshold: 1.0,\n      }\n    );\n  }\n\n  start(callback) {\n    this.#callback = callback;\n    this.#observer.observe(this.#container);\n  }\n\n  stop() {\n    this.#observer.unobserve(this.#container);\n    this.#callback = undefined;\n  }\n\n  async observeEntries([entry]) {\n    if (entry.isIntersecting && !this.#loading) {\n      this.#loading = true;\n      await this.#callback();\n      this.#loading = false;\n    }\n  }\n}\n","export default class Pagination {\n  #page = 1;\n  #maxPage = 0;\n  #totalItems = 0;\n  #itemsPerPage;\n\n  constructor(itemsPerPage) {\n    this.#itemsPerPage = itemsPerPage;\n  }\n\n  reset() {\n    this.#page = 1;\n    this.#maxPage = 0;\n    this.#totalItems = 0;\n  }\n\n  init(page, totalItems) {\n    this.#page = page;\n    this.#maxPage = Math.ceil(totalItems / this.#itemsPerPage);\n    this.#totalItems = totalItems;\n  }\n\n  get page() {\n    return this.#page;\n  }\n\n  get itemsPerPage() {\n    return this.#itemsPerPage;\n  }\n\n  get isActive() {\n    return this.#maxPage > 0;\n  }\n\n  get hasNextPage() {\n    return this.#maxPage > this.#page;\n  }\n  get nextPage() {\n    return this.#page + 1;\n  }\n\n  get totalItems() {\n    return this.#totalItems;\n  }\n}\n","export default class Loader {\n  #element;\n\n  constructor(element) {\n    this.#element = element;\n  }\n\n  show() {\n    this.#element.classList.remove('hidden');\n  }\n\n  hide() {\n    this.#element.classList.add('hidden');\n  }\n}\n","import { searchImages } from './service/pixabay.js';\nimport { renderGalleryItem } from './service/markup.js';\nimport Toast from './classes/toast.js';\nimport Gallery from './classes/gallery.js';\nimport InfiniteScroll from './classes/infinit-scroll.js';\nimport Pagination from './classes/pagination.js';\nimport Loader from './classes/loader.js';\n\nconst form = document.querySelector('.search-form');\n\nconst loader = new Loader(document.querySelector('.loader'));\nconst toast = new Toast('topRight');\nconst gallery = new Gallery('.gallery', renderGalleryItem);\nconst pagination = new Pagination(40);\nconst infiniteScroll = new InfiniteScroll(document.querySelector('.js-guard'));\n\nform.addEventListener('submit', handleForm);\n\nasync function loadPage(query, page) {\n  loader.show();\n  try {\n    const { hits, totalHits } = await searchImages(\n      query,\n      page,\n      pagination.itemsPerPage\n    );\n\n    gallery.addItems(hits);\n\n    pagination.init(page, totalHits);\n  } catch (error) {\n    toast.error(error.message);\n  } finally {\n    loader.hide();\n  }\n}\n\nasync function handleForm(event) {\n  event.preventDefault();\n\n  infiniteScroll.stop();\n  pagination.reset();\n  gallery.clear();\n\n  const query = event.currentTarget.searchQuery.value.trim();\n  if (!query) {\n    toast.warning('Write the search query!');\n    return;\n  }\n\n  await loadPage(query, 1);\n\n  if (!pagination.isActive) {\n    toast.warning(\n      \"We're sorry, but there are no images matching your search query.\"\n    );\n    return;\n  }\n\n  toast.success(`Hooray! We found ${pagination.totalItems} images.`);\n\n  infiniteScroll.start(async () => {\n    if (!pagination.hasNextPage) {\n      infiniteScroll.stop();\n      toast.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      return;\n    }\n\n    await loadPage(query, pagination.nextPage);\n  });\n}\n"],"names":["API_KEY","API_BASE_URL","searchImages","query","page","perPage","params","data","axios","renderGalleryItem","hit","webformatURL","tags","largeImageURL","likes","views","comments","downloads","Toast","position","iziToast","message","Gallery","gallerySelector","createGalleryItem","__privateAdd","_gallery","_lightBox","__publicField","__privateSet","SimpleLightbox","__privateGet","items","InfiniteScroll","container","_observer","_callback","_container","_loading","entries","callback","entry","Pagination","itemsPerPage","_page","_maxPage","_totalItems","_itemsPerPage","totalItems","Loader","element","_element","form","loader","toast","gallery","pagination","infiniteScroll","handleForm","loadPage","hits","totalHits","error","event"],"mappings":"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"}